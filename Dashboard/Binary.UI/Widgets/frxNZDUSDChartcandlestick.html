<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>   
	<script src="../Scripts/jquery-1.9.1.js"></script>
	<script src="../Scripts/Binary/Binary.Core.js"></script>
	<script src="../Scripts/Binary/Binary.Api.Proxy.js"></script>
	<script src="../Scripts/Binary/Binary.Api.Client.js"></script>

    <script src="../Widgets/highstock.js"></script>
    <script src="../Widgets/exporting_stocks.js"></script>
    <script src="../Widgets/ChartBarrier.js"></script>
    <script src="../Widgets/Localize.js"></script>
    <script src="../Widgets/LiveChartCommon.js"></script>
    <script src="../Widgets/LiveChartTick.js"></script>    
    <script src="../Widgets/LiveChartCandles.js"></script>
</head>
<body> 
    <script>
        $(document).ready(function ()
        {
            var live_chart;
            var chart_closed;
            var ticks_array = [];

            function updateLiveChart(config, data)//create new chart with data or update existing
            {
                if (live_chart)
                {
                    if (!chart_closed)
                    {
                        live_chart.close_chart();
                    }
                    live_chart = null;
                }
                if (config.resolution == 'tick')
                {
                    live_chart = new LiveChartTick(config);
                } else
                {
                    live_chart = new LiveChartOHLC(config);
                }
                live_chart.show_chart();

                live_chart.process_message(data, live_chart);
                chart_closed = false;
            }

            var minDT = new Date();
            minDT.setUTCFullYear(minDT.getUTCFullYear - 3);
            var liveChartsFromDT, liveChartsToDT, liveChartConfig = {};

            var updateDatesFromConfig = function (config)
            {
                //var duration = $('#live_chart_duration li[data-live=' + config.live + ']').attr('id');
                //var now = new Date();
                //liveChartsFromDT.setDateTime(new Date(now.getTime() - (duration * 1000)));
                //liveChartsToDT.setDateTime(now);
            };

            var show_chart_for_instrument = function (data) //changed
            {
                var symb, disp_symb;
                symb = 'frxNZDUSD';
                if (symb)
                {
                    liveChartConfig.symbol = symb;
                    liveChartConfig.chartType = 'candles';
                    if (liveChartConfig.chartType == 'ticks') liveChartConfig.resolution = 'tick';

                    //liveChartConfig.resolution = 'tick';
                    liveChartConfig.resolution = 'ohlc';
                    liveChartConfig.renderTo = 'container';
                    liveChartConfig.renderHeight = 300;


                    liveChartConfig.resolution_seconds = 1000;// for ohlc only

                    updateLiveChart(liveChartConfig, data);
                }
            };

            var build_markets_select = function ()
            {
                var market_select = $("#market_select");
                markets.each(function ()
                {
                    market_select.append("<option id='opt_" + this.name + "' value='" + this.name + "'>" + this.translated_display_name() + "</option>");
                });

                $("#market_select").val(liveChartConfig.market.name);
                build_instrument_select();

                $("#market_select").change(build_instrument_select);
            };

            var build_instrument_select = function ()
            {
                var instrument_select = $("#instrument_select");
                var market = markets.get($('#market_select').val());
                $("#instrument_span").hide();
                if (market)
                {
                    $("#instrument_select option").remove();
                    instrument_select.append("<option class='deleteme'></option>");
                    market.each(function ()
                    {
                        this.each(function ()
                        {
                            instrument_select.append("<option value='" + this.symbol + "'>" + this.translated_display_name() + "</option>");
                        });
                    });
                    $("#instrument_span").show();
                    $("#instrument_select").change(show_chart_for_instrument);
                    $("#instrument_select").val(liveChartConfig.symbol.symbol);
                }
            };

            var init_live_chart = function (data) //changed
            {
                configure_livechart();
                //build_markets_select();
                show_chart_for_instrument(data);
                //updateDatesFromConfig(liveChartConfig);
            };

            Binary.Api.Client.symbols(function (data)
            {
                init_live_chart(data);
            },
            Binary.Api.Intervals.Once,
            "frxNZDUSD",
            "candles",
            1406634683,
            1406726795,
            5000)
        });
	</script>
    <div id="container" style="min-width: 310px; height: 400px; margin: 0 auto"></div>

	<div id="result" style="font-size:10px; color:#666666"></div>
</body>
</html>